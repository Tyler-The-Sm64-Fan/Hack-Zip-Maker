<!DOCTYPE html>
<html>
<head>
<title>Hack Zip Maker</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
</head>
<body>

<h1>Hack Zip Maker</h1>

<h3>About</h3>
<p>
Upload a patch file (.bps, .ips, .ppf, .xdelta), edit the README, and optionally add images to showcase your hack. 
If README or images are left blank, defaults will be used. Uploaded images will appear inside a <strong>screenshots</strong> folder in the ZIP.
</p>

<br>

<label>ZIP File Name:</label><br>
<input type="text" id="zipName" placeholder="hack">
<br><br>

<label>Select Patch File:</label><br>
<input type="file" id="patchFile">
<br><br>

<label>Edit README (Optional):</label><br>
<textarea id="readmeEditor" rows="12" cols="60" placeholder="Leave blank to use default README..."></textarea>
<br><br>

<label>Import Showcase Images (Optional, max 30):</label><br>
<input type="file" id="imagesInput" accept="image/*" multiple>
<br><br>

<p id="message" style="color:red;"></p>

<button onclick="makeZip()">Download Hack ZIP</button>

<br><br>

<h3>Copyright</h3>
<p>
© 2026 Romhacking Studios. All rights reserved.<br>
This tool does NOT include any ROM files.
</p>

<script>
async function makeZip() {
  const allowedExtensions = ["bps", "ips", "ppf", "xdelta"];
  const fileInput = document.getElementById("patchFile");
  const zipNameInput = document.getElementById("zipName");
  const readmeEditor = document.getElementById("readmeEditor");
  const imagesInput = document.getElementById("imagesInput");
  const message = document.getElementById("message");

  message.textContent = "";

  if (!fileInput.files.length) {
    message.textContent = "Please upload a patch file.";
    return;
  }

  const file = fileInput.files[0];
  const fileName = file.name;
  const extension = fileName.split('.').pop().toLowerCase();

  if (!allowedExtensions.includes(extension)) {
    message.textContent = "Incorrect file format. Supported: .bps, .ips, .ppf, .xdelta";
    return;
  }

  const zipName = zipNameInput.value.trim() || "hack";
  let readmeContent = readmeEditor.value.trim();

  if (readmeContent === "") {
    readmeContent =
`Thank you for downloading this ROM hack patch.

This ZIP contains:
- ${fileName}
- README.txt

Supported Patch Formats:
- BPS
- IPS
- PPF
- XDELTA

How to Patch:
Use a patching tool that supports the included format.

Important:
This patch does NOT include a ROM.
You must provide your own legally obtained copy.

© 2026 Romhacking Studios`;
  }

  const zip = new JSZip();

  // Add patch file
  zip.file(fileName, file);

  // Add README
  zip.file("README.txt", readmeContent);

  // Add images inside screenshots folder
  const images = imagesInput.files;
  if (images.length > 30) {
    message.textContent = "You can upload a maximum of 30 images.";
    return;
  }

  if (images.length > 0) {
    const imgFolder = zip.folder("screenshots");
    for (let i = 0; i < images.length; i++) {
      imgFolder.file(images[i].name, images[i]);
    }
  }

  const blob = await zip.generateAsync({type:"blob"});
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = zipName + ".zip";
  link.click();
}
</script>

</body>
</html>